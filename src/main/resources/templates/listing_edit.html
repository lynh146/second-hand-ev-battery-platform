<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Sửa tin - EV MARKET</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/listing_edit.css">
</head>

<body>

<div th:replace="fragments/header :: header"></div>

<section class="container py-4">

    <h3 class="fw-bold mb-4">
        <i class="fa-solid fa-pen-to-square text-warning me-2"></i>
        Sửa tin đăng
    </h3>

    <form method="post" enctype="multipart/form-data"
          th:action="@{'/member/listings/update/' + ${listing.listingID}}">

        <!-- TYPE LABEL -->
        <div class="alert alert-info mb-4">
            <b>Loại tin:</b>
            <span th:if="${listing.vehicle != null}">Xe điện</span>
            <span th:if="${listing.battery != null}">Pin EV</span>
        </div>

        <!-- LOCKED FIELDS -->
        <div class="locked-section">
            <h5 class="fw-bold mb-3">Thông tin sản phẩm</h5>

            <div th:if="${listing.vehicle != null}">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Hãng xe</label>
                        <input class="form-control" th:value="${listing.vehicle.brand}" disabled>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Model</label>
                        <input class="form-control" th:value="${listing.vehicle.model}" disabled>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-4">
                        <label class="form-label">Loại xe</label>
                        <input class="form-control" th:value="${listing.vehicle.type}" disabled>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Năm sản xuất</label>
                        <input class="form-control" th:value="${listing.vehicle.manufactureYear}" disabled>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Km đã đi</label>
                        <input class="form-control" th:value="${listing.vehicle.mileage}" disabled>
                    </div>
                </div>
            </div>

            <div th:if="${listing.battery != null}">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Hãng pin</label>
                        <input class="form-control" th:value="${listing.battery.brand}" disabled>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Dung lượng</label>
                        <input class="form-control"
                               th:value="${listing.battery.capacityKWh + ' kWh'}" disabled>
                    </div>
                </div>
            </div>

        </div>

        <hr>

        <h5 class="fw-bold mb-3">Thông tin tin đăng</h5>

        <!-- TITLE -->
        <div class="mb-3">
            <label class="form-label">Tiêu đề tin</label>
            <input name="title" class="form-control" th:value="${listing.title}">
        </div>

        <!-- DESCRIPTION -->
        <div class="mb-3">
            <label class="form-label">Mô tả</label>
            <textarea name="description" rows="4" class="form-control"
                      th:text="${listing.description}"></textarea>
        </div>

        <!-- PRICE -->
        <div class="mb-3">
            <label class="form-label">Giá bán (VNĐ)</label>
            <input name="price" type="text" class="form-control price-input"
                th:value="${#numbers.formatInteger(listing.price,3,'POINT')}">

        </div>

        <h5 class="fw-bold mt-4">Hình ảnh</h5>

        <!-- OLD IMAGES -->
        <div class="image-preview-area mb-3">
            <div th:each="img : ${listing.images}" class="preview-box">
                <img th:src="${img.imageUrl}">
                <button type="button" class="preview-remove"
                        th:onclick="'deleteImage(' + ${img.listingImageID} + ')'">
                    &times;
                </button>
            </div>
        </div>

        <!-- ADD NEW IMAGES -->
        <div class="mb-3">
            <label class="form-label">Thêm ảnh mới</label>
            <input name="images" type="file" multiple accept="image/*"
                   class="form-control">
        </div>

        <button class="btn btn-warning px-4 py-2 fw-bold rounded-3">
            <i class="fa-solid fa-save me-2"></i>Lưu thay đổi
        </button>

    </form>

</section>

<div th:replace="fragments/footer :: footer"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/header.js}"></script>
<script th:src="@{/js/listing_edit.js}"></script>

</body>
</html>
